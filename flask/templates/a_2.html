<!DOCTYPE html>
<html lang="ko">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		{% if stock_name %}
		<title>{{stock_name}}</title>
		{%endif%}
		<title>주가 예측</title>
		<style>
			body {
				background-color: rgb(54,54,54);
        		margin: 0;
				border: 5px solid rgb(54,54,54);
				/* border-color: rgb(54,54,54); */
				display: flex;
				justify-content: space-between;
				overflow: scroll; /* 또는 overflow: scroll; */
			}
			.greeting {
				z-index: 100;
				position: absolute;
				top: 10px; /* 상단 여백 */
				left: 20%;
				transform: translateX(-50%);
				color: black;
				background-color: aliceblue;
				font-size: 2em; /* 텍스트 크기 조정 */
         	}
			.container {
				position:absolute;
				color: white;
        		width: fit-content;
				display: flex;
				flex-direction: column;
				background-color: rgb(54,54,54);
				z-index: 100;
				overflow: scroll;
			}
			.container form {
				z-index: 100;
				background-color: rgb(54,54,54);  
			}
			.img-wrapper {
				position: relative;
				width: 80vw; /* 이미지가 차지할 너비 (80% 화면 너비) */
				height: 100vh; /* 이미지가 차지할 높이 (화면 전체 높이) */
				overflow: hidden;
			}

			img {
				position: absolute;
				top: 0;
				left: 0; /* 이미지 위치를 원래 위치로 */
				width: 100%; /* 이미지의 크기를 100%로 유지 */
				clip-path: inset(0 0 0 7%); /* 왼쪽 10%만 잘라냄 */
				background-color: rgb(54,54,54);
			}
			
			.container h2{
				text-align: center;
			}
			.container p{
				text-align: center;
			}
			.right{
				display: flex;
				flex-direction: column;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<form action="/" method="POST">
				<input type="text" name="stock_name" value="" placeholder="종목 이름을 입력하세요">
				<br/>
				<input type="checkbox" name="sma5" value="sma5">sma5</input>
				<br/>
				<input type="checkbox" name="sma20" value="sma20">sma20</input>
				<br/>
				<input type="checkbox" name="sma100" value="sma100">sma100</input>
				<br/>
				<input type="checkbox" name="upper" value="upper">upper</input>
				<br/>
				<input type="checkbox" name="lower" value="lower">lower</input>
				<br/>
				<input type="checkbox" name="favor" value="favor">즐겨찾기</input>
				<br/>	
				<button id="submit" type="submit">Submit</button>
			</form>
			{% if stock_lst %}
				<h2>즐겨찾기</h2>
				<p>{{ stock_lst[0] }}</p>
				<p>{{ stock_lst[1] }}</p>
				<p>{{ stock_lst[2] }}</p>
			{% endif %}
			{% if lst1 %}
				<h2>명일 예상 종가</h2>
				<p>sma5: {{ lst1[0] }}원</p>
				<p>sma20: {{ lst1[1] }}원</p>
				<p>sma100: {{ lst1[2] }}원</p>
			{% endif %}
			{% if lst2 %}
				<h2>명일 종가에 대한 순수익</h2>
				<p>sma5: {{ lst2[0] }}원</p>
				<p>sma20: {{ lst2[1] }}원</p>
				<p>sma100: {{ lst2[2] }}원</p>
			{% endif %}
			{% if expect %}
				<h2>매매/매도</h2>
				<p>{{ expect }}</p>
			{% endif %}
			<a href="/list"><button>go to list</button></a>
			<a href="/my"><button>go to my page</button></a>

			
		</div>
		<div class="right">
			{% if stock_name %}
			<div class="greeting">{{ stock_name }}</div>
			{% endif %}
			{%if imgdata %}
			<div class="img-wrapper">
				<img src="data:image/png;base64,{{ imgdata }}">
			</div>
			{%endif%}

		</div>
		<!-- <canvas id="myChart"></canvas>
            <script>
				fetch('/data')
            .then(response => response.json())
            .then(jsonData => {
                // 캔들 차트 데이터 변환
                const chartData = jsonData.map(entry => ({
                    t: entry.date,
                    o: entry.open,
                    h: entry.high,
                    l: entry.low,
                    c: entry.close
                }));
				const ctx = document.getElementById('candleChart').getContext('2d');

                new Chart(ctx, {
                    type: 'candlestick',
                    data: {
                        datasets: [
                            {
                                label: 'Stock Price',
                                data: chartData,
                                borderColor: 'black',
                                backgroundColor: 'rgba(0, 0, 0, 0.1)'
                            },
                            {
                                label: 'SMA5',
                                data: sma5Data,
                                type: 'line',
                                borderColor: 'blue',
                                backgroundColor: 'transparent',
                                borderWidth: 2,
                                yAxisID: 'y'
                            },
                            {
                                label: 'Volume',
                                data: volumeData,
                                type: 'bar',
                                backgroundColor: 'rgba(0, 123, 255, 0.3)',
                                yAxisID: 'volume'
                            }
                        ]
                    },
                    options: {
                        scales: {
                            x: {
                                type: 'time',
                                time: {
                                    unit: 'day'
                                },
                                title: {
                                    display: true,
                                    text: 'Date'
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'Price'
                                }
                            },
                            volume: {
                                type: 'linear',
                                position: 'right',
                                title: {
                                    display: true,
                                    text: 'Volume'
                                },
                                grid: {
                                    drawOnChartArea: false
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: true
                            }
                        }
                    }
                });
            })
            .catch(error => console.error('Error fetching data:', error));
			</script> -->
	</body>
</html>
